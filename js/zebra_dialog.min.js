!function(D){"use strict";D.Zebra_Dialog=function(){var b,m={animation_speed_hide:250,animation_speed_show:0,auto_close:!(this.version="3.0.0"),auto_focus_button:!0,buttons:!0,center_buttons:!1,custom_class:!1,default_value:"",disable_page_scrolling:!0,height:0,keyboard:!0,margin:0,max_height:0,max_width:450,message:"",modal:!0,backdrop_close:!0,backdrop_container:"body",backdrop_opacity:".9",position:"center",reposition_speed:500,show_close_button:!0,source:!1,title:"",type:"information",vcenter_short_message:!0,width:0,onClose:null},_=this,h={},f=!1,y=!1,v=function(){var t,e,o,s,i,a=D(window).width(),n=D(window).height(),r=_.dialog.outerWidth(),d=_.dialog.outerHeight(),l=0,g=0;_.dialog_left=void 0,_.dialog_top=void 0,(i=(_.settings.margin+"").match(/^([0-9]+)(\%)?$/))&&(void 0!==i[2]?(l=parseInt(a*parseInt(i[1],10)/100,10),g=parseInt(n*parseInt(i[1],10)/100,10)):l=g=parseInt(i[1],10),isNaN(l)&&(l=g=0)),t={left:l,top:g,right:a-l-r,bottom:n-g-d,center:(a-r)/2,middle:(n-d)/2},D.isArray(_.settings.position)&&2===_.settings.position.length&&"string"==typeof _.settings.position[0]&&_.settings.position[0].match(/^(left|right|center)[\s0-9\+\-]*$/)&&"string"==typeof _.settings.position[1]&&_.settings.position[1].match(/^(top|bottom|middle)[\s0-9\+\-]*$/)&&(_.settings.position[0]=_.settings.position[0].toLowerCase(),_.settings.position[1]=_.settings.position[1].toLowerCase(),D.each(t,function(t,e){var o,s;for(o=0;o<2;o++)(s=_.settings.position[o].replace(t,e))!==_.settings.position[o]&&(0===o?_.dialog_left=p(s):_.dialog_top=p(s))})),void 0!==_.dialog_left&&void 0!==_.dialog_top||(_.dialog_left=t.center,_.dialog_top=t.middle),_.dialog_top<l&&(_.dialog_top=g),n-2*g<d+g?_.body.css("height",n-2*g-(D(".ZebraDialog_Title",_.dialog)?D(".ZebraDialog_Title",_.dialog).outerHeight():0)-(D(".ZebraDialog_Buttons",_.dialog)?D(".ZebraDialog_Buttons",_.dialog).outerHeight():0)-(parseFloat(_.body.css("marginTop"))||0)-(parseFloat(_.body.css("marginBottom"))||0)-(parseFloat(_.body.css("paddingTop"))||0)-(parseFloat(_.body.css("paddingBottom"))||0)-(parseFloat(_.body.css("borderTopWidth"))||0)-(parseFloat(_.body.css("borderBottomWidth"))||0)):y&&_.body.css("height",_.dialog.height()-(D(".ZebraDialog_Title",_.dialog)?D(".ZebraDialog_Title",_.dialog).outerHeight():0)-(D(".ZebraDialog_Buttons",_.dialog)?D(".ZebraDialog_Buttons",_.dialog).outerHeight():0)-(parseFloat(_.body.css("marginTop"))||0)-(parseFloat(_.body.css("marginBottom"))||0)-(parseFloat(_.body.css("paddingTop"))||0)-(parseFloat(_.body.css("paddingBottom"))||0)-(parseFloat(_.body.css("borderTopWidth"))||0)-(parseFloat(_.body.css("borderBottomWidth"))||0)),_.iframe&&_.iframe.css("height",_.body.height()-5),_.settings.vcenter_short_message&&(o=(e=_.body.find("div:first")).height())<(s=_.body.height())&&e.css("padding-top",(s-o)/2),"boolean"==typeof arguments[0]&&!1===arguments[0]||0===_.settings.reposition_speed?_.dialog.css({left:_.dialog_left,top:_.dialog_top,visibility:"visible",opacity:0}).animate({opacity:"1"},_.settings.animation_speed_show):(_.dialog.stop(!0),_.dialog.css("visibility","visible").animate({left:_.dialog_left,top:_.dialog_top},_.settings.reposition_speed)),void 0===b&&(!1!==_.settings.auto_focus_button?_.dialog.find("a[class^=ZebraDialog_Button]").eq(!0===_.settings.auto_focus_button?0:_.settings.auto_focus_button).focus():_.body.attr("tabindex",1).focus().removeAttr("tabindex")),_.settings.disable_page_scrolling&&_.settings.modal&&D("body").css({right:c(),top:-1*D(window).scrollTop()}).addClass("ZebraDialog_NoScroll")},c=function(){var t=D("<div>").css({visibility:"hidden",overflow:"scroll",msOverflowStyle:"scrollbar"}).appendTo(D("body")),e=D("<div>").appendTo(t),o=t.outerWidth()-e.outerWidth();return t.remove(),e.remove(),o},w=function(){switch(_.settings.type){case"confirmation":case"error":case"information":case"question":case"warning":case"prompt":return _.settings.type.charAt(0).toUpperCase()+_.settings.type.slice(1).toLowerCase();default:return!1}},p=function(t){var e=0;for(t=t.replace(/\s/g,"").match(/[+\-]?([0-9\.\s]+)/g)||[];t.length;)e+=parseFloat(t.shift());return e};return _.settings={},"string"==typeof arguments[0]&&(h.message=arguments[0]),"object"!=typeof arguments[0]&&"object"!=typeof arguments[1]||(h=D.extend(h,"object"==typeof arguments[0]?arguments[0]:arguments[1])),_.init=function(){var t,s,e,o,i,a,n,r,d,l,g,c,p,u=0;if(_.settings=D.extend({},m,h),_.settings.modal&&(_.backdrop=D("<div>",{"class":"ZebraDialogBackdrop"+(_.settings.custom_class?" "+_.settings.custom_class:"")}).css({position:"fixed",left:0,top:0,opacity:_.settings.backdrop_opacity+""}),"body"!==_.settings.backdrop_container&&(a=(i=_.settings.backdrop_container).offset(),_.backdrop.css({left:a.left,top:a.top,width:i.outerWidth(),height:i.outerHeight()})),_.settings.backdrop_close&&_.backdrop.on("click",function(){_.close()}),_.backdrop.appendTo(_.settings.backdrop_container)),_.dialog=D("<div>",{"class":"ZebraDialog"+(_.settings.custom_class?" "+_.settings.custom_class:"")+(!1!==w()?" ZebraDialog_Icon ZebraDialog_"+w():"")}).css({position:"fixed",left:0,top:0,visibility:"hidden"}),D(".ZebraDialog").each(function(){var t=D(this).css("zIndex");t&&u<t&&(u=t)}),0<u&&_.dialog.css("zIndex",u+1),!_.settings.buttons&&_.settings.auto_close&&_.dialog.attr("id","ZebraDialog_"+Math.floor(9999999*Math.random())),(c=(_.settings.width+"").match(/^([0-9]+)(\%)?$/))&&(c=void 0!==c[2]?parseInt(Math.max(document.documentElement.clientWidth,window.innerWidth||0)*parseInt(c[1],10)/100,10):parseInt(c[1],10),!isNaN(c)&&0<c&&_.dialog.css("width",c)),(isNaN(c)||0===c)&&(c=(_.settings.max_width+"").match(/^([0-9]+)(\%)?$/))&&(c=void 0!==c[2]?parseInt(Math.max(document.documentElement.clientWidth,window.innerWidth||0)*parseInt(c[1],10)/100,10):parseInt(c[1],10),!isNaN(c)&&0<c&&_.dialog.css("max-width",c)),(c=(_.settings.height+"").match(/^([0-9]+)(\%)?$/))&&(c=void 0!==c[2]?parseInt(Math.max(document.documentElement.clientHeight,window.innerHeight||0)*parseInt(c[1],10)/100,10):parseInt(c[1],10),!isNaN(c)&&0<c&&(_.dialog.css("height",c),y=!0)),(isNaN(c)||0===c)&&(c=(_.settings.max_height+"").match(/^([0-9]+)(\%)?$/))&&(c=void 0!==c[2]?parseInt(Math.max(document.documentElement.clientHeight,window.innerHeight||0)*parseInt(c[1],10)/100,10):parseInt(c[1],10),!isNaN(c)&&0<c&&(_.dialog.css("max-height",c),y=!0)),_.settings.title?g=D("<h3>",{"class":"ZebraDialog_Title"}).html(_.settings.title).appendTo(_.dialog):_.dialog.addClass("ZebraDialog_NoTitle"),_.body=D("<div>",{"class":"ZebraDialog_Body"}),"prompt"===_.settings.type&&(_.settings.message+='<input type="text" name="ZebraDialog_Prompt_Input" value="'+_.settings.default_value+'" class="ZebraDialog_Prompt_Input">'),_.settings.vcenter_short_message?D("<div>").html(_.settings.message).appendTo(_.body):_.body.html(_.settings.message),"prompt"===_.settings.type&&(_.settings.message=D(".ZebraDialog_Prompt_Input",_.body),D(".ZebraDialog_Prompt_Input",_.body).on("keypress",function(t){13===t.keyCode&&(f?f.trigger("click"):_.close(!0,this.value))})),_.settings.source&&"object"==typeof _.settings.source)for(p in o=_.settings.vcenter_short_message?D("div:first",_.body):_.body,_.settings.source)switch(p){case"ajax":t="string"==typeof _.settings.source[p]?{url:_.settings.source[p]}:_.settings.source[p],l=D("<div>").attr("class","ZebraDialog_Spinner").appendTo(o),t.success=function(t){l.remove(),o.append(t),v(!1)},D.ajax(t);break;case"iframe":n={width:"100%",marginheight:"0",marginwidth:"0",frameborder:"0"},r=D.extend(n,"string"==typeof _.settings.source[p]?{src:_.settings.source[p]}:_.settings.source[p]),_.iframe=D("<iframe>").attr(r).on("load",function(){D(".ZebraDialog_Spinner",_.body).remove()}),_.body.append(D("<div>").addClass("ZebraDialog_Spinner ZebraDialog_iFrame")),o.append(_.iframe);break;case"inline":o.append(_.settings.source[p])}return _.body.appendTo(_.dialog),(e=function(){if(!0!==_.settings.buttons&&!D.isArray(_.settings.buttons))return!1;if(!0===_.settings.buttons)switch(_.settings.type){case"question":case"warning":case"prompt":_.settings.buttons=["Ok","Cancel"];break;default:_.settings.buttons=["Ok"]}return _.settings.buttons}())?(s=D("<div>",{"class":"ZebraDialog_Buttons"}).appendTo(_.dialog),D.each(e,function(t,o){var e=D("<a>",{href:"javascript:void(0)","class":"ZebraDialog_Button_"+t+(void 0!==o.custom_class&&""!==o.custom_class.toString().trim()?" "+o.custom_class:"")});void 0!==o.caption?e.html(o.caption):e.html(o),e.on("click",function(){var t=!0,e="prompt"===_.settings.type&&D(".ZebraDialog_Prompt_Input",_.body).length?D(".ZebraDialog_Prompt_Input",_.body).val():void 0;void 0!==o.callback&&(t=o.callback(_.dialog,e)),!1!==t&&_.close(void 0!==o.caption?o.caption:o,e)}),e.appendTo(s),void 0!==o.default_confirmation&&o.default_confirmation&&(f=e)}),_.settings.center_buttons&&s.addClass("ZebraDialog_Buttons_Centered")):_.dialog.addClass("ZebraDialog_NoButtons"),_.dialog.appendTo("body"),_.settings.show_close_button?D('<a href="javascript:void(0)" class="ZebraDialog_Close">&times;</a>').on("click",function(t){t.preventDefault(),_.close()}).appendTo(g||_.body):_.dialog.addClass("ZebraDialog_NoCloseButton"),D(window).on("resize.ZebraDialog",function(){clearTimeout(b),b=setTimeout(function(){v()},100)}),_.settings.keyboard&&D(document).on("keyup.ZebraDialog",function(t){return 27===t.which&&_.close(),!0}),!1!==_.settings.auto_close&&(_.dialog.on("click",function(){clearTimeout(_.timeout),_.close()}),_.timeout=setTimeout(_.close,_.settings.auto_close)),v(!1),"prompt"===_.settings.type&&(D(".ZebraDialog_Prompt_Input",_.body).focus(),""!==_.settings.default_value&&(_.settings.message.get(0).setSelectionRange?(d=2*_.settings.default_value.length,setTimeout(function(){_.settings.message.get(0).setSelectionRange(d,d)},1)):_.settings.message.val(_.settings.default_value))),_},_.close=function(t,e){var o=Math.abs(parseInt(D("body").css("top"),10));D(document).off(".ZebraDialog"),D(window).off(".ZebraDialog"),_.backdrop&&_.backdrop.off("click").animate({opacity:"0"},_.settings.animation_speed_hide,function(){_.backdrop.remove()}),_.dialog.animate({top:"0",opacity:"0"},_.settings.animation_speed_hide,function(){_.dialog.remove(),_.settings.onClose&&"function"==typeof _.settings.onClose&&_.settings.onClose(void 0!==t?t:"",e)}),_.settings.disable_page_scrolling&&_.settings.modal&&(D("body").removeClass("ZebraDialog_NoScroll").css({right:"",top:""}),D(window).scrollTop(o))},_.update=function(){clearTimeout(b),b=setTimeout(function(){v()},100)},_.init()}}(jQuery);